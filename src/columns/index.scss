$grid-max-columns: 6;

$grid-desktop: repeat(12, 1fr); // Same as 12 instances of 1fr.
$grid-tablet: repeat(8, 1fr);
$grid-mobile: repeat(4, 1fr);

// Standard Gutenberg Breakpoints
$break-wide: 1280px;
$break-xlarge: 1080px;
$break-large: 960px;	// admin sidebar auto folds
$break-medium: 782px;	// adminbar goes big
$break-small: 600px;
$break-mobile: 480px;
$break-zoomed-in: 280px;

$grid-gutter: 24px;


/**
 * Grid Columns
 */
.wp-block-group > .wp-block-columns.is-css-grid {
	max-width: 100%;
}
.wp-block-columns.is-css-grid,
.wp-block-columns.block-editor-block-list__block.wp-block.is-css-grid {
	box-sizing: border-box;
	// Prevent long unbroken words from overflowing.
	word-break: break-word; // For back-compat.
	overflow-wrap: break-word; // New standard.

	display: grid;
	grid-gap: $grid-gutter;
	grid-template-columns: $grid-mobile;


	// Horizontal divider line for mobile columns that take up the entire grid of 4 column spans.
	&.has-divider {
		// Enable horizontal divider line for mobile columns that take up the entire grid of 4 column spans.
		& > .wp-block-column[class*="-mobile-grid__span-4"] {
			&:not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):before {
				content: "";
				border-top: 1px solid #eaeaea;
				display: block;
				padding-bottom: $grid-gutter;
			}
			&:not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):after {
				display: none;
			}
		}
		// Enable vertical divider line for all columns.
		& > .wp-block-column:not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):after {
			content: "";
			position: absolute;
			height: 100%;
			top: 0;
			left: calc( -1 * ( $grid-gutter / 2 ) );
			border-left: 1px solid #eaeaea;
		}
	}

	.wp-block-column {
		height: 100%;
		width: 100%;
		position: relative;
		box-sizing: border-box;
		& > * {
			box-sizing: border-box;
		}
	}

	// Grid rules.
	// Mobile first.
	@for $i from 1 through 12 {
		@for $x from 1 through 4 {
			& > .wp-block-column.column#{ $x }-mobile-grid__start-#{ $i } {
				grid-column-start: $i;
			}
		}
	}

	@for $i from 1 through 12 {
		@for $x from 1 through 4 {
			& > .wp-block-column.column#{ $x }-mobile-grid__span-#{ $i }  {
				grid-column-end: span $i; // Set it to span $i columns, regardless of starting position.
			}
		}
	}

	@for $i from 1 through 4 {
		@for $x from 1 through 4 {
			& > .wp-block-column.column#{ $x }-mobile-grid__row-#{ $i } {
				grid-row-start: $i;
			}
		}
	}

	// Tablet grid rules.
	@media (min-width: #{ ($break-small) }) {
		grid-template-columns: $grid-tablet;

		// Divider Lines
		&.has-divider {
			// Enable tablet horizontal divider
			& > .wp-block-column[class*="-tablet-grid__span-8"] {
				&:not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):before {
					content: "";
					border-top: 1px solid #eaeaea;
					display: block;
					padding-bottom: $grid-gutter;
				}
				&:not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):after {
					display: none!important;
				}
			}
			// Disable mobile horizontal divider
			& > .wp-block-column[class*="-mobile-grid__span-4"]:not([class*="-tablet-grid__span-8"]):not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):before {
				display: none!important;
			}
			& > .wp-block-column[class*="-mobile-grid__span-4"]:not([class*="-tablet-grid__span-8"]):not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):after {
				display: block!important;
			}
		}

		@for $i from 1 through 12 {
			@for $x from 1 through 4 {
				& > .wp-block-column.column#{ $x }-tablet-grid__start-#{ $i } {
					grid-column-start: $i;
				}
			}
		}

		@for $i from 1 through 12 {
			@for $x from 1 through 4 {
				& > .wp-block-column.column#{ $x }-tablet-grid__span-#{ $i }  {
					grid-column-end: span $i; // Set it to span $i columns, regardless of starting position.
				}
			}
		}

		@for $i from 1 through 4 {
			@for $x from 1 through 4 {
				& > .wp-block-column.column#{ $x }-tablet-grid__row-#{ $i } {
					grid-row-start: $i;
				}
			}
		}
	}


	// Desktop grid rules.
	@media (min-width: #{ ($break-large) }) {
		grid-template-columns: $grid-desktop;

		// Setup vertical divider lines
		&.has-divider {
			& > .wp-block-column[class*="-tablet-grid__span-8"]:not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):before {
				display: none!important;
			}
			& > .wp-block-column[class*="-tablet-grid__span-8"]:not(:first-of-type):not(.is-selected):not(.is-highlighted):not(.is-hovered):after {
				display: block!important;
			}
		}

		@for $i from 1 through 12 {
			@for $x from 1 through 6 {
				& > .wp-block-column.column#{ $x }-grid__start-#{ $i } {
					grid-column-start: $i;
				}
			}
		}

		@for $i from 1 through 12 {
			@for $x from 1 through 6 {
				& > .wp-block-column.column#{ $x }-grid__span-#{ $i }  {
					grid-column-end: span $i; // Set it to span $i columns, regardless of starting position.
				}
			}
		}

		@for $i from 1 through 4 {
			@for $x from 1 through 4 {
				& > .wp-block-column.column#{ $x }-grid__row-#{ $i } {
					grid-row-start: $i;
				}
			}
		}
	}
}
